---
description: Не менять текущую логику генерации параметров пользовательских блоков
globs: generator.js
alwaysApply: false
---

## Генерация параметров блоков — не трогать

При работе с файлом `generator.js` **запрещено менять** уже реализованную логику генерации параметров (`paramsXml` в `createUbiXmlSixx`), а именно:

- **Связку с `defines` и переменными**:
  - Параметры собираются из `variables` с `info.role === 'parameter'` и из `defines` c `d.role === 'parameter'`.
  - Для `defines` с ролью `parameter` директива `#define` **не попадает** в секцию `declare`, а используется только как параметр.

- **Структуру XML для параметров**:
  - Адаптер `InputsOutputsAdaptorForUserBlock` + объект `UserBlockParametr` создаются в точности как сейчас.
  - Имя параметра берётся из `(varInfo.alias || name)`.
  - Тип параметра формируется через `createSixxDataTypeSimple(varInfo.type, paramTypeId)` (без добавления `class`, без `instanceCollection`).
  - Блоки `hasDefaultValue`, `hasUpRange`, `hasDownRange`, `comment`, `id` должны оставаться без изменений по структуре и месту в XML.

- **Обработку значений по умолчанию**:
  - Для `String`‑параметров значение по умолчанию пишется в `stringDefaultValue` как есть, с экранированием только через `escapeHtml`.
  - Для числовых/логических типов значения по умолчанию пишутся в `numberDefaultValue` с типами `Float` или `SmallInteger` по текущим правилам.

Если нужно добавить новую функциональность, делайте это **рядом** или выше/ниже, но **не меняйте существующий код генерации параметров и не меняйте его поведение**.

